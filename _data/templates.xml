<?xml version="1.0" encoding="utf-8"?>
<templates>
  <template type="public" title="bdapi_account_api" version_id="2000000" version_string="2.0.0"><![CDATA[<xf:title>{{ phrase('bdapi_home') }}</xf:title>

<xf:wrap template="account_wrapper"/>

<xf:pageaction if="{$canAddClient}">
    <xf:button href="{{ link('account/api/client-add') }}" class="button--cta" data-xf-click="overlay" icon="add">
        {{ phrase('bdapi_client_add') }}
    </xf:button>
</xf:pageaction>

<div class="block">
    <div class="block-container">
        <h2 class="block-header">{{ phrase('bdapi_clients') }}</h2>
        <ol class="block-body">
            <xf:foreach loop="$clients" value="$client">
                <li class="block-row block-row--separated">
                    <xf:macro template="bdapi_client_macros" name="list_item" arg-client="{$client}"/>
                </li>
            </xf:foreach>
        </ol>
    </div>
</div>
]]></template>
  <template type="public" title="bdapi_account_api_client_add" version_id="2000000" version_string="2.0.0"><![CDATA[<xf:title>{{ phrase('bdapi_client_add') }}</xf:title>

<xf:wrap template="account_wrapper"/>

<xf:macro template="bdapi_client_macros" name="form" arg-client="{$client}"/>]]></template>
  <template type="public" title="bdapi_account_api_client_delete" version_id="2000000" version_string="2.0.0"><![CDATA[<xf:title>{{ phrase('confirm_action') }}</xf:title>

<xf:wrap template="account_wrapper"/>

<xf:form action="{{ link('account/api/client-delete') }}" ajax="true" class="block">
    <div class="block-container">
        <div class="block-body">
            <xf:inforow rowtype="confirm">
                {{ phrase('please_confirm_that_you_want_to_delete_following:') }}
                <strong>
                    <a href="{$client.redirect_uri}" target="_blank">{$client.name}</a>
                    ({{ phrase('bdapi_client_id:') }} {$client.client_id})
                </strong>
            </xf:inforow>
        </div>

        <xf:hiddenval name="client_id" value="{$client.client_id}"/>
        <xf:submitrow rowtype="simple" icon="delete"/>
    </div>
</xf:form>]]></template>
  <template type="public" title="bdapi_account_api_client_edit" version_id="2000000" version_string="2.0.0"><![CDATA[<xf:title>{{ phrase('bdapi_client_edit') }}</xf:title>

<xf:wrap template="account_wrapper"/>

<xf:macro template="bdapi_client_macros" name="form" arg-client="{$client}"/>]]></template>
  <template type="public" title="bdapi_account_authorize" version_id="2000011" version_string="2.0.0 Alpha 1"><![CDATA[<xf:title>{{ phrase('bdapi_authorize_access') }}</xf:title>

<xf:wrap template="account_wrapper"/>

<xf:form action="{{ link('account/authorize', null, $linkParams) }}" class="block">
    <div class="block-container">
        <div class="block-body">
            <xf:formrow label="">
                <xf:if is="$clientIsAuto">
                    {{ phrase('bdapi_please_confirm_to_authorize_access_auto') }}

                    <xf:else/>
                    {{ phrase('bdapi_please_confirm_to_authorize_access:') }}
                </xf:if>
            </xf:formrow>

            <xf:formrow label="{{ phrase('bdapi_client') }}"
                        explain="{$client.description}">
                {$client.name}
            </xf:formrow>

            <xf:checkboxrow label="{{ phrase('bdapi_requested_scopes') }}">
                <xf:foreach loop="$needAuthScopes" key="$scopeId" value="$scopeDescription">
                    <xf:option name="scopes[]" value="{$scopeId}" checked="1">
                        {$scopeDescription}
                    </xf:option>
                </xf:foreach>
            </xf:checkboxrow>

            <xf:formrow label="">
                {{ phrase('bdapi_you_will_be_redirected_x', {
                'redirectUri': {$linkParams.redirect_uri},
                'clientName': {$client.name}
                }) }}
            </xf:formrow>
        </div>

        <xf:hiddenval name="client_id" value="{$client.client_id}"/>

        <xf:submitrow icon="lock" sticky="true" submit="{{ phrase('bdapi_authorize_access') }}"/>
    </div>
</xf:form>
]]></template>
  <template type="public" title="bdapi_account_wrapper" version_id="2000000" version_string="2.0.0"><![CDATA[<a class="blockLink {{ $pageSelected == 'api' ? 'is-selected' : '' }}" href="{{ link('account/api') }}">
    {{ phrase('bdapi_home') }}
</a>]]></template>
  <template type="public" title="bdapi_client_macros" version_id="2000000" version_string="2.0.0"><![CDATA[<xf:macro name="list_item" arg-client="!">
    <div class="contentRow">
        <div class="contentRow-main">
            <h3 class="contentRow-header">
                <a href="{$client.redirect_uri}" target="_blank">{$client.name}</a>
            </h3>

            <div class="contentRow-lesser" dir="auto">
                {$client.description}
            </div>

            <div class="contentRow-minor">
                <ul class="listInline listInline--bullet">
                    <li>
                        <dl class="pairs pairs--inline">
                            <dt>{{ phrase('bdapi_client_id') }}</dt>
                            <dd>{$client.client_id}</dd>
                        </dl>
                    </li>
                    <li>
                        <dl class="pairs pairs--inline">
                            <dt>{{ phrase('bdapi_client_secret') }}</dt>
                            <dd>{$client.client_secret}</dd>
                        </dl>
                    </li>
                    <li>
                        <a href="{{ link('account/api/client-edit', null, {'client_id': {$client.client_id}}) }}"
                           data-xf-click="overlay">
                            {{ phrase('edit') }}
                        </a>
                    </li>
                    <li>
                        <a href="{{ link('account/api/client-delete', null, {'client_id': {$client.client_id}}) }}"
                           data-xf-click="overlay">
                            {{ phrase('delete') }}
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</xf:macro>

<xf:macro name="form" arg-client="">
    <xf:form action="{{ link('account/api/client-save') }}" class="block" ajax="true">
        <div class="block-container">
            <div class="block-body">
                <xf:textboxrow label="{{ phrase('bdapi_client_name') }}" name="name" value="{$client.name}"/>

                <xf:textarearow label="{{ phrase('bdapi_client_description') }}" name="description"
                                value="{$client.description}"/>

                <xf:textboxrow label="{{ phrase('bdapi_client_redirect_uri') }}"
                               name="redirect_uri"
                               type="url"
                               value="{$client.redirect_uri}"/>

                <xf:textarearow explain="{{ phrase('bdapi_whitelisted_domains_explain') }}"
                                hint="{{ phrase('optional') }}"
                                label="{{ phrase('bdapi_whitelisted_domains') }}"
                                name="options[whitelisted_domains]"
                                value="{$client.options.whitelisted_domains}"/>
            </div>

            <xf:if is="{$client}">
                <xf:hiddenval name="client_id" value="{$client.client_id}"/>
            </xf:if>

            <xf:submitrow icon="save" sticky="true"/>
        </div>
    </xf:form>
</xf:macro>
]]></template>
</templates>
